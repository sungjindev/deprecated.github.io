---
title: C++ 입출력 속도 개선
categories: [Computer science, Algorithm]
tags: [알고리즘, 코딩 테스트, C++]
---

저번 포스팅에서 언급했던 것처럼 요즘은 프로그래머스에서 넘어와 백준이라는 사이트에서 알고리즘 및 코딩 테스트 공부를 하고 있습니다. 이에 따라 입출력 처리를 직접 해줘야하는 경우가 생기는데, C++이 기본적으로 C의 입출력보다 많이 느려서 이를 개선하는 방법에 대한 포스팅을 해보려고 합니다.

## C++ 입출력 속도
> C와 비교했을 때 C++의 입출력 속도는 얼마나 느린 것인지 알아봤습니다. 실제로 실험 결과를 봤을 때 출력의 경우 큰 차이가 없었지만 입력의 경우 scanf를 쓰는 경우 평균 0.9206초가 걸리고 cin을 쓰는 경우는 평균 2.1742초가 걸리며 2배 이상의 차이가 났습니다. 지금부터는 이렇게 늦은 속도를 어떻게 개선할 수 있는지 알아봅시다.

## C++ 입출력 속도 개선
> 결론부터 말하자면 C++ 내 메인 함수에서 아래의 코드를 작성해주면 속도 개선을 할 수 있습니다.
```cpp
ios::sync_with_stdio(false); cin.tie(NULL); cout.tie(NULL);
```
위 코드를 통해 C와 C++의 stream 동기화를 끊을 수 있습니다. 동기화를 끊는다는 것은 C++이 독립적인 buffer를 가지게 된다는 것을 의미합니다. 이에따라 buffer의 크기가 줄어들어 속도 개선이 이뤄질 수 있습니다. 이렇게 하면 출력한 뒤 바로 화면에 보이지 않고 프로그램 실행이 끝난 뒤 한번에 보여지게 됩니다. 하지만 이는 알고리즘 문제를 풀 때 문제가 되지 않습니다. 사실 그것보다 중요한 문제는 이처럼 했을 때 C의 표준 입출력을 함께 사용해서는 안된다는 점입니다. 예를 들어 scanf(), printf(), getchar() 등의 함수를 쓸 수 없습니다. C와 C++의 표준 입출력을 함께 사용하게 되면 동기화를 끊어 놨기 때문에 프로그래머가 기대한대로 출력 순서가 보장되지 않기 때문입니다. 참고로 getline은 C++의 표준 입출력을 사용하기 때문에 정상적인 사용이 가능합니다. 그 외에도 멀티 스레드가 아닌 싱글 스레드 환경에서만 사용 가능합니다. 하지만 알고리즘 문제를 풀면서 멀티 스레드 환경을 사용할 일은 없으므로 이 부분 역시 걱정 안하셔도 됩니다. 이렇게 버퍼를 분리시켜준 뒤에 속도 측정을 다시 해보니 cin을 사용했을 때 평균 0.5938초가 걸린다고 합니다. 이는 scanf와 비교했을 때 거의 2배 가까이 빠른 속도를 보여주는 것입니다. 출력을 하기 위한 cout 같은 경우에는 평균 0.8272초로 거의 차이가 안났습니다.

## endl 대신 '\n' 사용
> 입출력 속도 개선을 위해 추가적으로 endl 대신 '\n'을 사용하는 습관을 들여야 합니다. endl은 개행 문자를 출력할 뿐만 아니라 출력 버퍼를 비우는 역할까지 합니다. 그런데 이 버퍼를 비우는 작업이 굉장히 오래 걸립니다. 우리가 알고리즘 문제를 풀면서 반복되는 개행 문자의 입출력이 있을텐데 endl을 사용한다면 그때마다 이렇게 시간적인 손해를 보게 되는 것입니다. 따라서 '\n'을 사용하여 이렇게 낭비되는 시간을 줄입시다.

## References
> https://www.acmicpc.net/board/view/22716  
https://ip99202.github.io/posts/%EC%9E%85%EC%B6%9C%EB%A0%A5-%EC%86%8D%EB%8F%84-%EC%A4%84%EC%9D%B4%EA%B8%B0/
