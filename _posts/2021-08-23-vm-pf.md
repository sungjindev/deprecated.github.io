---
title: 기술 면접_ 가상 메모리와 페이지 폴트
categories: [Computer science, Technical interview]
tags: [CS, 기술 면접, 가상 메모리, 페이지 폴트, computer science, technical interview, virtual memory, page fault]
---

!본 포스팅은 기술 면접을 대비하기 위한 포스팅입니다.

## 가상 메모리란?
> **보조 기억장치에 비해 상대적으로 작은 크기를 가지고 있는 메모리를, 더욱 더 효율적이고 대용량으로 사용하기 위해 사용하는 기술**입니다.
특정 시점마다 실제 사용하는 메모리는 그렇게 크지 않다는 점에 착안해서 고안된 기술입니다.
이 외에도, 가상 메모리 기법을 사용하면서 얻을 수 있는 이점이 많이 있습니다.
가상 메모리를 사용하게 되면 프로세스 간 공간 분리를 하게 되는데 이를 통해 **프로세스 간 메모리 영역 침범 이슈를 방지**할 수 있고 **보조 기억장치를 활용하면서 메모리 용량 부족에 대한 이슈도 해결**할 수 있습니다. 가상 메모리 기법을 사용하게 되면 CPU는 메모리의 실제 주소인 Physical address대신 Virtual address에 먼저 접근하게 됩니다. 이때 **페이지 테이블을 참조하여 Virtual address를 Physical address로 변환하여 실제 메모리에 접근하게 되는데 이러한 변환 과정이 굉장히 빈번하게 일어나고 속도가 굉장히 중요하므로 MMU라는 하드웨어 칩의 지원을 받습니다.**

## MMU(Memory Management Unit)란?
> **MMU는 Memory Management Unit으로 CPU가 코드를 실행하며 가상 메모리 주소에 접근할 때 해당 가상 메모리 주소를 실제 물리적인 주소로 변환해주는 하드웨어 장치**입니다.

## Page란?
> 가상 메모리 기법을 사용할 때 어느정도의 크기씩 실제 메모리에 올려놓을 지 고민하게 되는데, 이때 **기본 단위가 되는 것이 페이지**입니다. **페이지 단위로 관리하게 되며 페이지 번호를 바탕으로 가상 메모리 주소와 실제 메모리 주소를 매핑하여 페이지 테이블에 기록하고 관리**하게 됩니다.
더 구체적으로 가상 메모리 주소에 대하여 알아보면 **가상 메모리 주소 v = (p, d)와 같은 pair**로 이루어져 있습니다.
**p는 가상 메모리 페이지를 의미하며 d는 distance로 p 내 offset**을 의미합니다.

## 가상 메모리 기법의 흐름
> 지금까지 배운 가상 메모리 기법의 흐름을 한번 정리해보면, **CPU가 명령어를 실행하던 중 가상 메모리 주소를 참조하게 되면 하드웨어 칩셋인 MMU를 거쳐서 실제 메모리에 올라가있는 페이지 테이블을 참조하여 실질적인 메모리 주소로 변환하게 되고 그 주소를 바탕으로 메모리에 접근**하게 됩니다. 여기서 알 수 있듯이 **메모리에 반복적으로 접근하고 데이터를 읽어오게 되는데 이러한 속도는 CPU나 레지스터 처리 속도에 비하면 굉장히 느린 속도입니다. 이 부분에서 성능 향상을 위해서 TLB라는 하드웨어를 사용**하게 됩니다.

![virtual-memory](/assets/img/technical_interview/virtual-memory.png){: w="50%" h="50%" style="border:1px solid #eaeaea; border-radius: 7px; padding: 0px;"}

## TLB(Translation Lookaside Buffer)란?
> **TLB란 Translation Lookaside Buffer의 약자로, 최근에 접근한 페이지 정보를 기록하는 하드웨어 칩셋**입니다. **즉, 가상 메모리 주소가 한번 물리 주소로 변환되면 TLB에 기록하고 있다가 그다음부터는 MMU가 페이지 테이블을 참조하는 것이 아니라 TLB에서 해당하는 물리 주소를 먼저 찾게 됩니다. 이를 통해 상대적으로 속도가 느린 메모리에 접근하는 횟수를 줄여 성능 향상**을 꾀할 수 있습니다.

## 페이지 폴트(Page fault)란?
> 우리가 가상 메모리 주소를 통해서 실제 물리 주소를 얻고 메모리에 접근했지만 내가 원하는 페이지가 실제 메모리에 적재되어 있지 않을 수도 있습니다. 우리는 가상 메모리 기법을 쓰고 있기 때문에 일부만 실제 메모리에 올리고 나머지는 보조 기억장치에 저장하고 있기 때문입니다. 이렇게 **내가 찾는 페이지가 실제 메모리에 현재 적재되어 있지 않을 때를 페이지 폴트**라고 합니다. 페이지 폴트가 발생하면 보조 기억장치에서 지금 내가 필요한 페이지를 가져오게 됩니다. **보조 기억장치는 메모리보다 속도가 더 느리기 때문에 자주 참조하면 좋지 않을 것입니다. 따라서 페이지 폴트를 줄이기 위해서도 다양한 기법들이 사용**됩니다. 가급적이면 앞으로 실행될 코드나 참조될 데이터들을 예측해서 미리 메모리에 올려놓는 것이 좋습니다. 이러한 기법에 대해서는 추후 포스팅에서 더 자세히 알아보도록 합시다.

## References
> https://velog.io/@gndan4/OS-%EA%B0%80%EC%83%81-%EB%A9%94%EB%AA%A8%EB%A6%AC